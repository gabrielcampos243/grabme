<div class="text-center mt-4">
  <div class="top-box d-flex justify-content-center">
    <h1>Dashboard</h1>
    <%= image_tag "pie-chart.png", class:"pie-chart" %>
  </div>
</div>

<div class="container d-flex flex-column bd-highlight">
  <%if user_signed_in?%>
    <%if @my_service != nil%>
      <div class="my-dashboard-card m-3 dashboard-cards p-3">
        <div class="position-of-service-jobs d-flex justify-content-around">
          <div class="my-service">
            <h2> My Service</h2>
            <%= cl_image_tag @my_service.photo.key, height: 300, width: 400, crop: :fill %>
            <p> Description: <%= @my_service.description %></p>
            <p> Price: <%=@my_service.price %>€</p>
          </div>

<div class="my-jobs">
            <div class="my-jobs-info">
            <h2>My Jobs</h2>
              <% @my_jobs.each do |job| %>
                <div class="card p-4 m-2">
                  <p> <strong><%=job.user.username %></strong> Booked you!</p>
                  <p> <strong>From:</strong> <%=job.start_date %> <strong>To:</strong> <%= job.end_date %> </p>
                  <p> + <%=(((job.end_date - job.start_date).to_i*24)* job.partner.price )%> € </p>
                </div>
              <% end %>
          </div>
        </div>
      </div>

        <div class="my-service-buttons">
          <div class="button-1 m-2">
            <%= link_to "Edit", edit_partner_path(@my_service) %>
          </div>
          <div class="button-1 m-2">
            <%= link_to "Delete", partner_path(@my_service), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
          </div>
        </div>
        </div>
      <% else %>
        <div class="btn btn-success">
          <%= link_to "List yourself as a partner!", new_partner_path %>
        </div>
      <% end %>



    <div class="my-bookings m-3 dashboard-cards p-3">
      <h2>My bookings</h2>
      <%if @my_bookings.count >= 1%>

        <% @my_bookings.each do |booking| %>
          <div class="p-4 mt-3">
            <h1><%= booking.partner.name %></h1>
            <%= cl_image_tag booking.partner.photo.key, height: 300, width: 400, crop: :fill %>
            <p> <strong>From:</strong> <%= booking.start_date %> <strong>To:</strong> <%= booking.end_date %></p>
            <p> <strong>Cost:</strong> <%=((booking.end_date - booking.start_date)* 24) * booking.partner.price %> € </p>
            <div class="d-flex align-items-center justify-content-center">
              <%= link_to "Cancel" , booking_path(booking), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
              <img src="https://cdn.betterttv.net/emote/5baaf017ed3de76aa4212261/3x" alt="sad" width="40px">
            </div>
          </div>
        <% end %>

      <% else %>
          <h2>I'm sorry but no bookings were found...</h2>
          <div class="container d-flex justify-content-center align-items-start">
            <div class="pepe">
              <%= image_tag "pepe_sad" %>
            </div>
          </div>
      <% end %>

      </div>

    <% else %>
      <h1>User not loged in...</h1>

 <% end %>
</div>
